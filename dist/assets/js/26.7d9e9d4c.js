(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{380:function(s,a,e){"use strict";e.r(a);var n=e(42),t=Object(n.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"如何安装-mysql"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何安装-mysql"}},[s._v("#")]),s._v(" 如何安装 mysql")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("具体步骤不赘述，官网安装速度太慢，推荐使用"),e("a",{attrs:{href:"http://mirrors.sohu.com/mysql/MySQL-8.0/",target:"_blank",rel:"noopener noreferrer"}},[s._v("国内镜像"),e("OutboundLink")],1),s._v("；")])]),s._v(" "),e("li",[e("p",[s._v("解压完成后，配置全局变量")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("变量名：MYSQL_HOME\n变量值：E:\\XX\\mysql-5.7.20-winx64\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("Path 路径(win7)")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("在路径最后添加\n;E:\\xx\\mysql-8.0.19-winx64\\bin\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("生成 data 文件")]),s._v(" "),e("p",[s._v("以管理员身份运行 cmd，进入 E:\\mysql\\mysql-8.0.12-winx64\\bin>下")]),s._v(" "),e("p",[s._v("执行命令：")]),s._v(" "),e("p",[e("code",[s._v("mysqld --initialize-insecure --user=mysql")])]),s._v(" "),e("p",[s._v("在 E:\\python\\mysql\\mysql-8.0.12-winx64\\bin 目录下生成 data 目录")])]),s._v(" "),e("li",[e("p",[s._v("安装 mysql")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("mysqld --install mysql8.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("code",[s._v("--install")]),s._v(" 后面的"),e("code",[s._v("mysql8.0")]),s._v("是自定义名")]),s._v(" "),e("p",[s._v("如果显示 Service successfully installed，代表安装服务 mysql8.0 已经成功，接下来启动服务：")])]),s._v(" "),e("li",[e("p",[s._v("启动服务")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("net start mysql8.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("如果显示"),e("code",[s._v("mysql8.0 服务正在启动 .")]),s._v(" ~~~ "),e("code",[s._v("mysql8.0 服务已经启动成功。")])]),s._v(" "),e("p",[s._v("那就明白已经安装全部 okay 啦，就可以登录数据库了！")])]),s._v(" "),e("li",[e("p",[s._v("设置 root 密码")]),s._v(" "),e("p",[s._v("先登录进入数据库")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql  -u root\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("如果出现一堆字符，写着"),e("code",[s._v("welcome")]),s._v("什么的那就表示正常登录进数据库啦，只不过目前使用的初始密码")]),s._v(" "),e("p",[s._v("然后我们就修改密码，8.0 的修改密码语句为：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("alter user 'root'@'localhost' identified by 'new password';\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("这里修改完后，"),e("code",[s._v("exit")]),s._v("退出 mysql，重新登录时就需要输入密码了（-p 表示输入密码）")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql  -u root -p\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("p",[s._v("这里"),e("code",[s._v("mysql")]),s._v("就全部设置完成了，这里再说一下日常开发我们使用的软件，如"),e("code",[s._v("navcat")]),s._v("；")]),s._v(" "),e("p",[s._v("不赘述安装过程，但目前使用"),e("code",[s._v("mysql8.0")]),s._v("版本和"),e("code",[s._v("navcat12")]),s._v("，用"),e("code",[s._v("navicat")]),s._v("连接时，出现了报错如下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("Authentication plugin 'caching_sha2_password' cannot be loaded\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("查阅资料了解：出现这个原因是 mysql8 之前的版本中加密规则是 mysql_native_password，而在 mysql8 之后,加密规则是 caching_sha2_password；")]),s._v(" "),e("p",[s._v("解决问题方法有两种：")]),s._v(" "),e("ul",[e("li",[s._v("一种是升级 navicat 驱动")]),s._v(" "),e("li",[s._v("一种是把 mysql 用户登录密码加密规则还原成 mysql_native_password.")])]),s._v(" "),e("p",[s._v("这里说一下第二种方法：")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("登录数据库")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(" mysql -u root -p\n\n // 密码666666\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("修改账户密码加密规则并更新用户密码")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("ALTER USER 'root'@'localhost' IDENTIFIED BY 'password' PASSWORD EXPIRE NEVER;   #修改加密规则\n\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'password';   #更新一下用户的密码\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("刷新权限并重置密码")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(" FLUSH PRIVILEGES;   #刷新权限\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("再次重置密码")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("alter user 'root'@'localhost' identified by '666666';\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("p",[s._v("然后就可以解决此问题。")]),s._v(" "),e("blockquote",[e("p",[s._v("Shelljs 是 Node.js 下的脚本语言解析器，具有丰富且强大的底层操作(Windows/Linux/OS X)权限。Shelljs 本质就是基于 node 的一层命令封装插件，让前端开发者可以不依赖 linux 也不依赖类似于 cmder 的转换工具，而是直接在我们最熟悉不过的 javascript 代码中编写 shell 命令实现功能。")]),s._v(" "),e("p",[s._v("shelljs 做的事就是自动化，从耗时的重复性常规动作里解放出来，提升开发效率和工作心情。")])]),s._v(" "),e("h2",{attrs:{id:"开机自启动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#开机自启动"}},[s._v("#")]),s._v(" 开机自启动")]),s._v(" "),e("h3",{attrs:{id:"pm2-使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pm2-使用"}},[s._v("#")]),s._v(" PM2 使用")]),s._v(" "),e("p",[s._v("这里介绍"),e("code",[s._v("PM2")]),s._v("进行开机自启动 nodejs 项目；")]),s._v(" "),e("p",[s._v("先全局安装"),e("code",[s._v("pm2")]),s._v(":")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("npm install pm2 -g\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("因为我们的 nodejs 项目使用的是"),e("code",[s._v("typescript")]),s._v("，所以再安装一下"),e("code",[s._v("ts")]),s._v("依赖；")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("pm2 install typescript\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("因为 PM2 项目启动的是 js 文件，所以我们先把"),e("code",[s._v("ts")]),s._v("构建一下"),e("code",[s._v("npm run build")]),s._v(";")]),s._v(" "),e("p",[s._v("然后启动 pm2;")]),s._v(" "),e("p",[s._v("okay，cd 到 serve 项目根目录，启动！")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("pm2 start serve.js --name='xxx'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("不确定是否启动成功，可以监听一下活动端口，是否有当前端口：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("netstat\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("这里就开启了一个永久后台启动的 nodejs 项目了。")]),s._v(" "),e("h3",{attrs:{id:"开机自启动-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#开机自启动-2"}},[s._v("#")]),s._v(" 开机自启动")]),s._v(" "),e("p",[s._v("这里如果想在 windows 下，开机自启动 node 项目；")]),s._v(" "),e("p",[s._v("可以安装"),e("code",[s._v("pm2-windows-service")]),s._v("模块来支持；")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("npm i -g pm2-windows-service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"添加-pm2-环境变量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加-pm2-环境变量"}},[s._v("#")]),s._v(" 添加 pm2 环境变量")]),s._v(" "),e("p",[s._v("添加系统环境变量 "),e("code",[s._v("PM2_HOME=D:\\.pm2")]),s._v("\n右键 [我的电脑] - [属性] - [高级系统设置] - [环境变量] - 新建 [系统变量]\n名称"),e("code",[s._v("PM2_HOME")]),s._v("\n路径"),e("code",[s._v("D:\\.pm2")]),s._v("（这路径根据自己需要定）")]),s._v(" "),e("h3",{attrs:{id:"安装服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装服务"}},[s._v("#")]),s._v(" 安装服务")]),s._v(" "),e("p",[s._v("以管理员权限打开新的命令行窗口,执行以下命令来安装服务")]),s._v(" "),e("div",{staticClass:"language-undefined line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("pm2-service-install\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("code",[s._v("Perform environment setup ?")]),s._v(" 选 n, 继续\n此时, PM2 服务已安装成功并已启动, 可以通过 Wn+R 来查看，输入"),e("code",[s._v("services.msc")]),s._v("即可看到服务")]),s._v(" "),e("h3",{attrs:{id:"启动-node-程序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动-node-程序"}},[s._v("#")]),s._v(" 启动 node 程序")]),s._v(" "),e("p",[s._v("下面用 pm2 来启动我们自己的服务程序 app.js, 然后告诉 pm2 开机后自动运行我 app.js\n继续在管理员命令行下, cd 到 app.js 所在目录")]),s._v(" "),e("div",{staticClass:"language-css line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-css"}},[e("code",[s._v("pm2 start app.js --name myapp\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("查看服务列表")]),s._v(" "),e("div",{staticClass:"language-cpp line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[s._v("pm2 list\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("添加到自启动服务")]),s._v(" "),e("div",{staticClass:"language-undefined line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("pm2 save\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("code",[s._v("pm2 save")]),s._v("很重要, 它保存当前 pm2 正在管理的 NodeJS 服务, 并在开机后恢复这些服务\n至此, 安装配置完成")]),s._v(" "),e("h3",{attrs:{id:"卸载服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#卸载服务"}},[s._v("#")]),s._v(" 卸载服务")]),s._v(" "),e("div",{staticClass:"language-undefined line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("pm2-service-uninstall\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"pm2-常用命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pm2-常用命令"}},[s._v("#")]),s._v(" pm2 常用命令")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('$ pm2 start app.js # 启动app.js应用程序\n$ pm2 start app.js -i 4 # cluster mode 模式启动4个app.js的应用实例\n# 4个应用程序会自动进行负载均衡\n$ pm2 start app.js --name="api" # 启动应用程序并命名为 "api"\n$ pm2 start app.js --watch # 当文件变化时自动重启应用\n$ pm2 start script.sh # 启动 bash 脚本\n\n$ pm2 list # 列表 PM2 启动的所有的应用程序\n$ pm2 monit # 显示每个应用程序的CPU和内存占用情况\n$ pm2 show [app-name] # 显示应用程序的所有信息\n\n$ pm2 logs # 显示所有应用程序的日志\n$ pm2 logs [app-name] # 显示指定应用程序的日志\npm2 flush\n\n$ pm2 stop all # 停止所有的应用程序\n$ pm2 stop 0 # 停止 id为 0的指定应用程序\n$ pm2 restart all # 重启所有应用\n$ pm2 reload all # 重启 cluster mode下的所有应用\n$ pm2 gracefulReload all # Graceful reload all apps in cluster mode\n$ pm2 delete all # 关闭并删除所有应用\n$ pm2 delete 0 # 删除指定应用 id 0\n$ pm2 scale api 10 # 把名字叫api的应用扩展到10个实例\n$ pm2 reset [app-name] # 重置重启数量\n\n$ pm2 startup # 创建开机自启动命令\n$ pm2 save # 保存当前应用列表\n$ pm2 resurrect # 重新加载保存的应用列表\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br")])]),e("h2",{attrs:{id:"日志服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#日志服务"}},[s._v("#")]),s._v(" 日志服务")]),s._v(" "),e("h3",{attrs:{id:"种类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#种类"}},[s._v("#")]),s._v(" 种类")]),s._v(" "),e("p",[s._v("日志服务分为代码中为两种：")]),s._v(" "),e("ul",[e("li",[e("h3",{attrs:{id:"定位问题产出的日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#定位问题产出的日志"}},[s._v("#")]),s._v(" 定位问题产出的日志")])]),s._v(" "),e("li",[e("h3",{attrs:{id:"请求记录日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#请求记录日志"}},[s._v("#")]),s._v(" 请求记录日志")])])]),s._v(" "),e("p",[s._v("定位问题产出的日志我们可以通过在代码中引入库来完成，好用的有"),e("code",[s._v("morgan")]),s._v("、"),e("code",[s._v("winston")]),s._v("等等；")]),s._v(" "),e("p",[s._v("这里只列出使用介绍，不详细讲解配置信息；")]),s._v(" "),e("p",[s._v("使用"),e("code",[s._v("morgan")]),s._v("库实现日志服务；")]),s._v(" "),e("blockquote",[e("p",[s._v("使用方法可参照官方项目示例："),e("a",{attrs:{href:"https://www.npmjs.com/package/morgan",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.npmjs.com/package/morgan"),e("OutboundLink")],1)]),s._v(" "),e("p",[s._v("详细进阶方法可访问："),e("a",{attrs:{href:"https://github.com/chyingp/nodejs-learning-guide/blob/master/%E8%BF%9B%E9%98%B6/%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97morgan.md",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/chyingp/nodejs-learning-guide/blob/master/%E8%BF%9B%E9%98%B6/%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97morgan.md"),e("OutboundLink")],1)])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("自定义日志格式\n首先搞清楚morgan中的两个概念：format 跟 token。非常简单：\n\nformat：日志格式，本质是代表日志格式的字符串，比如 :method :url :status :res[content-length] - :response-time ms。\ntoken：format的组成部分，比如上面的:method、:url即使所谓的token。\n搞清楚format、token的区别后，就可以看下morgan中，关于自定义日志格式的关键API。\n\nmorgan.format(name, format);  // 自定义日志格式\nmorgan.token(name, fn);  // 自定义token\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("示例：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("var express = require('express');\nvar app = express();\nvar morgan = require('morgan');\n\n// 自定义token\nmorgan.token('from', function(req, res){\n    return req.query.from || '-';\n});\n\n// 自定义format，其中包含自定义的token\nmorgan.format('joke', '[joke] :method :url :status :from');\n\n// 使用自定义的format\napp.use(morgan('joke'));\n\napp.use(function(req, res, next){\n    res.send('ok');\n});\n\napp.listen(3000);\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br")])]),e("h3",{attrs:{id:"pm2-产出监控日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pm2-产出监控日志"}},[s._v("#")]),s._v(" pm2 产出监控日志")]),s._v(" "),e("p",[s._v("如我们一个持久化的服务，在运行时如果需要错误日志，我们可以通过"),e("code",[s._v("pm2.json")]),s._v("配置文件完成；")]),s._v(" "),e("p",[s._v("pm2.json 可以配置多个运行的进程参数；")]),s._v(" "),e("p",[s._v("详细配置可以参照： https://www.cnblogs.com/bq-med/p/9012438.html")]),s._v(" "),e("h2",{attrs:{id:"文件上传"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#文件上传"}},[s._v("#")]),s._v(" 文件上传")]),s._v(" "),e("p",[s._v("可以使用插件库解决，"),e("code",[s._v("Multiparty")]),s._v("和"),e("code",[s._v("Formidable")]),s._v("；")]),s._v(" "),e("p",[s._v("Multiparty 可以用来解析 FormData 数据，Formidable 也是与之功能相同的插件；")]),s._v(" "),e("h2",{attrs:{id:"登录鉴权"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#登录鉴权"}},[s._v("#")]),s._v(" 登录鉴权")]),s._v(" "),e("p",[s._v("可以使用"),e("code",[s._v("express-jwt")]),s._v("插件库；")]),s._v(" "),e("p",[s._v("Node.js 上 Token 鉴权常用的是 passport，它可以自定义校验策略，但如果你是用 express 框架，又只是解析 JWT 这种简单需求，可以尝试下 express-jwt 这个中间件。")]),s._v(" "),e("h2",{attrs:{id:"项目分层"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目分层"}},[s._v("#")]),s._v(" 项目分层")]),s._v(" "),e("p",[s._v("3 层架构，controller service DAO")]),s._v(" "),e("p",[s._v("sql 写在 DAO 层中；")])])}),[],!1,null,null,null);a.default=t.exports}}]);