(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{381:function(s,n,a){"use strict";a.r(n);var t=a(42),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("前言，最近项目用到了 Nginx 做反向代理，顺便记录一篇博文。")]),s._v(" "),a("h2",{attrs:{id:"nignx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nignx"}},[s._v("#")]),s._v(" Nignx")]),s._v(" "),a("p",[s._v("Nginx 同 Apache 一样都是一种 Web 服务器，但其轻量级的体积，及高并发等特点广受好评;")]),s._v(" "),a("h3",{attrs:{id:"优点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优点"}},[s._v("#")]),s._v(" 优点")]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("性能方面")])]),s._v(" "),a("p",[s._v("Nginx 是专门为性能优化而开发的，实现上非常注重效率。")]),s._v(" "),a("p",[s._v("它采用内核 Poll 模型，可以支持更多的并发连接，最大可以支持对 5 万个并发连接数的响应，而且只占用很低的内存资源。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("稳定性方面")])]),s._v(" "),a("p",[s._v("Nginx 采取了分阶段资源分配技术，使得 CPU 与内存的占用率非常低。")]),s._v(" "),a("p",[s._v("Nginx 官方表示，Nginx 保持 1 万个没有活动的连接，而这些连接只占用 2.5MB 内存，")]),s._v(" "),a("p",[s._v("因此，类似 DOS 这样的攻击对 Nginx 来说基本上是没有任何作用的。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("高可用性方面")])]),s._v(" "),a("p",[s._v("Nginx 支持热部署，启动速度特别迅速，因此可以在不间断服务的情况下，对软件版本或者配置进行升级，")]),s._v(" "),a("p",[s._v("即使运行数月也无需重新启动，几乎可以做到 7x24 小时不间断地运行。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("效率方面")])]),s._v(" "),a("p",[s._v("作为 Web 服务器，Nginx 处理静态文件、索引文件，自动索引的效率非常高。")])])]),s._v(" "),a("h2",{attrs:{id:"web-服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web-服务器"}},[s._v("#")]),s._v(" web 服务器")]),s._v(" "),a("p",[s._v("说到这个名字了，简单说一下定义：")]),s._v(" "),a("blockquote",[a("p",[s._v("当我们使用 PC 并通过浏览器查看网站时，页面访问到的服务器都是我们都可称之为 Web 服务器。")])]),s._v(" "),a("h3",{attrs:{id:"那-web-服务器做了什么呢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#那-web-服务器做了什么呢"}},[s._v("#")]),s._v(" 那 web 服务器做了什么呢？")]),s._v(" "),a("p",[s._v("再等一下（。。估计看文的大家心想，我就是想看看 nignx 是什么，怎么牵扯出了这么多东西），")]),s._v(" "),a("p",[s._v("了解 web 服务器做了什么之前，我们先说一下使用浏览器访问页面是怎么一个流程；")]),s._v(" "),a("ol",[a("li",[s._v("用户使用浏览器，输入想要访问的网址（"),a("strong",[s._v("域名")]),s._v("：例如"),a("code",[s._v("http://www.baidu.com")]),s._v("）；")]),s._v(" "),a("li",[s._v("浏览器访问"),a("strong",[s._v("DNS")]),s._v("服务器，查询得到域名对应的"),a("strong",[s._v("IP")]),s._v("；")]),s._v(" "),a("li",[s._v("浏览器通过"),a("strong",[s._v("IP")]),s._v("，向"),a("strong",[s._v("web 服务器")]),s._v("发送资源请求； （注意这里 web 服务器登场了）")]),s._v(" "),a("li",[a("strong",[s._v("web 服务器")]),s._v("根据请求，向"),a("strong",[s._v("计算机")]),s._v("获取所需资源；")]),s._v(" "),a("li",[a("strong",[s._v("web 服务器")]),s._v("将获取到的资源返回给浏览器；")]),s._v(" "),a("li",[a("strong",[s._v("浏览器")]),s._v("接收到返回的资源（例如 HTML），"),a("strong",[s._v("解析")]),s._v("成页面，展示给用户；")])]),s._v(" "),a("p",[s._v("那 web 服务器到底做什么了？")]),s._v(" "),a("p",[s._v("一般 web 服务器都会有配置映射文件地址，也就是文件路径和 URL 的关系映射；")]),s._v(" "),a("p",[s._v("我们看第 4 步，web 服务器接到请求"),a("code",[s._v("URL")]),s._v("后，解析"),a("code",[s._v("URL")]),s._v("字符串；")]),s._v(" "),a("p",[s._v("通过解析得到的"),a("code",[s._v("URL")]),s._v("，拿到映射的文件路径，在计算器磁盘中就可以获取静态资源，然后将资源返回给浏览器；")]),s._v(" "),a("p",[s._v("所以 web 服务器就是做了"),a("strong",[s._v("静态资源分配")]),s._v("这个事，供外界远程访问；")]),s._v(" "),a("p",[s._v("也是 web 服务器最常用的场景。")]),s._v(" "),a("p",[s._v("严格意义上 web 服务器只负责处理"),a("code",[s._v("http")]),s._v("协议，管理静态资源，其他内容都"),a("strong",[s._v("转交")]),s._v("给其他应用服务器来做；")]),s._v(" "),a("p",[s._v("怎么转交呢？")]),s._v(" "),a("p",[s._v("那么就是使用 Nignx 的"),a("strong",[s._v("反向代理")]),s._v("功能了，这也就是 Nignx 常见的使用方式；")]),s._v(" "),a("h3",{attrs:{id:"常见的-web-服务器有哪些呢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见的-web-服务器有哪些呢"}},[s._v("#")]),s._v(" 常见的 web 服务器有哪些呢？")]),s._v(" "),a("p",[s._v("Nginx、Apache、Lighttpd 等等很多；")]),s._v(" "),a("h2",{attrs:{id:"nginx-使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-使用"}},[s._v("#")]),s._v(" Nginx 使用")]),s._v(" "),a("p",[s._v("了解 Nginx 是什么后，那么赶紧说一下怎么使用吧。")]),s._v(" "),a("p",[s._v("分为三步：")]),s._v(" "),a("p",[s._v("1.下载安装")]),s._v(" "),a("p",[s._v("到官网直接下载 windows 版就可以了，解压即可；")]),s._v(" "),a("p",[s._v("2.运行 Nignx")]),s._v(" "),a("p",[s._v("使用 CMD 进入到解压目录，命令"),a("code",[s._v("start nginx")]),s._v("看到一个窗口闪现，nginx 就成功启动了！")]),s._v(" "),a("p",[s._v("是不是很简单...：|")]),s._v(" "),a("p",[s._v("3.验证")]),s._v(" "),a("p",[s._v("浏览器打开"),a("code",[s._v("lacalhost:80")]),s._v("，如果显示 nginx 欢迎页，则表示启动成功；")]),s._v(" "),a("p",[s._v("到这里 Nginx 已经 ok 了！")]),s._v(" "),a("p",[s._v("接下来就告诉他，怎么让它变成一个成熟的 nginx，承担起上面提到"),a("strong",[s._v("web 服务器")]),s._v("的责任吧")]),s._v(" "),a("h3",{attrs:{id:"静态资源托管"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#静态资源托管"}},[s._v("#")]),s._v(" 静态资源托管")]),s._v(" "),a("p",[s._v("上面也说了浏览器获取网页的步骤，那么当浏览器发送请求给 web 服务器的时候，我们现在手握 nginx 应该怎么办呢？")]),s._v(" "),a("p",[a("strong",[s._v("配置代理映射")]),s._v("即可！")]),s._v(" "),a("p",[s._v("打开 nginx 解压路径"),a("code",[s._v("nginx-1.9.9\\conf\\nginx.conf")]),s._v("这个"),a("strong",[s._v("配置文件")]),s._v("；")]),s._v(" "),a("p",[s._v("这个文件就是 ngnix 的配置文件，所有你需要的功能配置，都在这个文件里搞定；")]),s._v(" "),a("p",[s._v("打开到 35 行左右，会发现下面这段代码，这里就主要配置的内容了：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("server {\n        listen       80;               // nginx服务端口\n        server_name  localhost;\n\n        #charset koi8-r;\n\n        #access_log  logs/host.access.log  main;\n\n        location / {\n            root   html;                         // 现在映射的资源是默认的nginx欢迎页（相对路径）\n            index  index.html index.htm;      // 这里index表示默认文件，nginx会优先从这些文件里匹配\n        }\n\t\t...\n\t\t...\n\t\t...\n}\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("这里举个栗子，")]),s._v(" "),a("p",[s._v("如果我们要实现图片资源的访问，浏览器输入"),a("code",[s._v("location:80/public/cake.jpg")]),s._v("，")]),s._v(" "),a("p",[s._v("希望获取到电脑上想要的"),a("code",[s._v("E:/nginx-1.12.9/static/cake.jpg")]),s._v("这张图片时；")]),s._v(" "),a("p",[s._v("那我们用 location 来匹配文件映射即可， 上代码：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("server {\n        listen       80;               // nginx服务端口\n        server_name  localhost;\n\n        #charset koi8-r;\n\n        #access_log  logs/host.access.log  main;\n\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n\n\t\tlocation /public {\n            alias   E:/nginx-1.12.9/static/;   //alias表示将location映射到的路径替换\n\t\t   autoindex on;                 //表示可以访问目录，显示文件列表（类似ftp）\n        }\n\t\t...\n}\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[s._v("通过这个配置就可以实现浏览器输入的 URL 虽然是"),a("code",[s._v("location:80/public/cake.jpg")]),s._v("，")]),s._v(" "),a("p",[s._v("但我们的 web 服务器 nginx 收到后，将其中的"),a("code",[s._v("public")]),s._v("替换为"),a("code",[s._v("E:/nginx-1.12.9/static/")]),s._v("，")]),s._v(" "),a("p",[s._v("所以最终指向了文件路径"),a("code",[s._v("E:/nginx-1.12.9/static/cake.jpg")]),s._v("；")]),s._v(" "),a("p",[s._v("这样就实现了"),a("strong",[s._v("web 服务器")]),s._v("的静态资源托管！")]),s._v(" "),a("h3",{attrs:{id:"配置属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置属性"}},[s._v("#")]),s._v(" 配置属性")]),s._v(" "),a("p",[s._v("这里在说明一下 location 中常用的一些配置属性；")]),s._v(" "),a("ol",[a("li",[a("h3",{attrs:{id:"root-和-alias-设置静态资源根目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#root-和-alias-设置静态资源根目录"}},[s._v("#")]),s._v(" root 和 alias === 设置静态资源根目录")]),s._v(" "),a("blockquote",[a("p",[s._v("这两个常用来访问文件系统；")])]),s._v(" "),a("p",[s._v("alias：表示直接替换掉 location 指定的 url；")]),s._v(" "),a("p",[s._v("​ "),a("strong",[s._v("需要注意 alias 指定的 url，结尾要以"),a("code",[s._v("/")]),s._v("结尾！否则会出现无法匹配")])]),s._v(" "),a("p",[s._v("root：表示将新路径拼接到 location 之前")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("例如:\nlocation /public {\n      root E:/nginx-1.12.9/static/;  // 这里的最终映射URL为 E:/nginx-1.12.9/static/public\n      index  index.html index.htm;\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])]),s._v(" "),a("li",[a("h3",{attrs:{id:"autoindex-访问目录时列出文件列表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#autoindex-访问目录时列出文件列表"}},[s._v("#")]),s._v(" autoindex === 访问目录时列出文件列表")]),s._v(" "),a("p",[s._v("设置后，该地址打开会生成目录页面，类似于 ftp 服务；")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("location /public {\n      root E:/nginx-1.12.9/static/;\n      autoindex on;\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("h3",{attrs:{id:"index-优先匹配文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#index-优先匹配文件"}},[s._v("#")]),s._v(" index === 优先匹配文件")]),s._v(" "),a("p",[s._v("这里设置的文件，如果访问的是目录文件夹地址，nginx 会优先匹配指定文件，如果匹配到，则直接展示；")])]),s._v(" "),a("li",[a("h3",{attrs:{id:"proxy-pass-反向代理配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#proxy-pass-反向代理配置"}},[s._v("#")]),s._v(" proxy_pass === 反向代理配置")]),s._v(" "),a("blockquote",[a("p",[s._v("常用于代理请求，适用于前后端负载分离或多台机器、服务器负载分离的场景；")]),s._v(" "),a("p",[s._v("例如，服务器上部署了配置的静态资源映射，用来访问主页 HTML，")]),s._v(" "),a("p",[s._v("HTML 中的请求，我们使用反向代理来配置到指定的服务 serve 上；")])]),s._v(" "),a("p",[s._v("例如实际请求为："),a("code",[s._v("http://192.168.0.1/api/get_list")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("(1).\nlocation /api/ {\n    proxy_pass http://127.0.0.1:8080; // 结尾不加'/'，最终URL为： http://127.0.0.1:8080/api/list\n}\n\n(2).\nlocation /api/ {\n    proxy_pass http://127.0.0.1:8080/; // 结尾加'/'，最终URL为： http://127.0.0.1:8080/list\n}\n\n(3).\nlocation /api/ {\n    proxy_pass http://127.0.0.1:8080/test/;\n}\n// 结尾加'/'，最终URL为： http://127.0.0.1:8080/test/get_list\n\n(4).\nlocation /api/ {\n    proxy_pass http://127.0.0.1:8080/test;\n}\n// 结尾加'/'，最终URL为： http://127.0.0.1:8080/testget_list\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])])])]),s._v(" "),a("p",[s._v("这样就配置好了基础的 web 服务器，实现了基本功能；")]),s._v(" "),a("p",[s._v("虽然 web 服务器的作用很简单，目的也很明确，就是管理静态资源；")]),s._v(" "),a("p",[s._v("但 nginx 能做的显然不止这么点，无论是反向代理负载均衡、gzip 压缩、跨域设置等等很多功能都可以简单做到；")]),s._v(" "),a("p",[s._v("实现方式都是在配置文件中设置，碍于篇幅，暂不赘述了。先把 nginx 用起来吧~ ：)")]),s._v(" "),a("h2",{attrs:{id:"location-详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#location-详解"}},[s._v("#")]),s._v(" location 详解")]),s._v(" "),a("p",[s._v("location 语法规则很简单，一个"),a("code",[s._v("location")]),s._v("关键字，后面跟着可选的修饰符；")]),s._v(" "),a("p",[s._v("最后是要匹配的字符，花括号中是要执行的操作。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// location 修饰符 URL {执行内容}\n\nlocation [ = | ~ | ~* | ^~ ] url {\n\t...\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"修饰符"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修饰符"}},[s._v("#")]),s._v(" 修饰符")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("=")]),s._v(" 表示精确匹配。只有请求的 url 路径与后面的字符串完全相等时，才会命中。")]),s._v(" "),a("li",[a("code",[s._v("~")]),s._v(" 表示该规则是使用正则定义的，区分大小写。")]),s._v(" "),a("li",[a("code",[s._v("~*")]),s._v(" 表示该规则是使用正则定义的，不区分大小写。")]),s._v(" "),a("li",[a("code",[s._v("^~")]),s._v(" 表示如果该符号后面的字符是最佳匹配，采用该规则，不再进行后续的查找。")])]),s._v(" "),a("h3",{attrs:{id:"匹配类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#匹配类型"}},[s._v("#")]),s._v(" 匹配类型")]),s._v(" "),a("p",[s._v("从修饰符可以看出 location 有"),a("strong",[s._v("两种表示形式")]),s._v("，")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("一种是使用前缀字符，也就是直接使用"),a("code",[s._v("URL")]),s._v("中的字符匹配；")])]),s._v(" "),a("li",[a("p",[s._v("一种是使用正则。")])])]),s._v(" "),a("p",[s._v("所以如果是正则匹配的话，前面有"),a("code",[s._v("~")]),s._v("或"),a("code",[s._v("~*")]),s._v("修饰符。")]),s._v(" "),a("h3",{attrs:{id:"匹配规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#匹配规则"}},[s._v("#")]),s._v(" 匹配规则")]),s._v(" "),a("p",[s._v("可以先排一下匹配规则的"),a("strong",[s._v("优先程度")]),s._v("；")]),s._v(" "),a("p",[s._v("精准匹配 > 正则匹配 > 前缀字符匹配")]),s._v(" "),a("p",[s._v("为什么这样认为呢？因为 Location 匹配顺序是这样：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("首先先检查使用前缀字符定义的 location，选择最长匹配的项并记录下来。（这里并没有使用，只是记录暂存）")])]),s._v(" "),a("li",[a("p",[s._v("如果找到了精确匹配的 location，也就是使用了"),a("code",[s._v("=")]),s._v("修饰符的 location，结束查找，使用它的配置。")]),s._v(" "),a("p",[s._v("（这也就能说明精准匹配优先度最高，只要符合直接执行并结束）")])]),s._v(" "),a("li",[a("p",[s._v("如果没有精准匹配，然后就按顺序查找使用正则定义的 location，")]),s._v(" "),a("p",[s._v("如果匹配则停止查找，使用它定义的配置。 （这里就是正则优先程度居其次）")])]),s._v(" "),a("li",[a("p",[s._v("最后如果没有匹配的任何正则 location，则使用前面记录的最长匹配前缀字符 location。")]),s._v(" "),a("p",[s._v("（前缀字符匹配优先程度最低）")])])]),s._v(" "),a("p",[s._v("也需要注意的是，因为正则和精准匹配的特性，所以他们只要匹配后，就不会再往下查找；")]),s._v(" "),a("h2",{attrs:{id:"常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[s._v("#")]),s._v(" 常用命令")]),s._v(" "),a("h3",{attrs:{id:"linux-下"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux-下"}},[s._v("#")]),s._v(" linux 下")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("启动Nginx服务\n\n要启动Nginx服务，请运行以下命令。 请注意，如果配置语法不正确，此过程可能会失败。\n\n$ sudo systemctl start nginx\n或者\n$ sudo service nginx start\n\n启用Nginx服务\n\n上一个命令仅在此期间启动服务，要在启动时启用它自动启动，请运行以下命令。\n\n$ sudo systemctl enable nginx\n或者\n$ sudo service nginx enable\n\n重启Nginx服务\n\n要重新启动Nginx服务，将停止然后启动该服务的操作。\n\n$ sudo systemctl restart nginx\n或者\n$ sudo service nginx restart\n\n查看Nginx服务状态\n\n您可以按如下方式检查Nginx服务的状态。 此命令显示有关服务的运行时状态信息。\n\n$ sudo systemctl status nginx\n或者\n$ sudo service nginx status\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("h2",{attrs:{id:"nginx-配置-gzip-压缩"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-配置-gzip-压缩"}},[s._v("#")]),s._v(" nginx 配置 gzip 压缩")]),s._v(" "),a("p",[s._v("【参考】: "),a("code",[s._v("https://blog.csdn.net/qq_15807277/article/details/91909372")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    #开启gzip压缩\n    gzip on;\n    #http的协议版本\n    gzip_http_version 1.0;\n    #IE版本1-6不支持gzip压缩，关闭\n    gzip_disable 'MSIE[1-6].';\n    #需要压缩的文件格式 text/html默认会压缩，不用添加\n    gzip_types text/css text/javascript application/javascript;\n    #设置压缩缓冲区大小，此处设置为4个8K内存作为压缩结果流缓存\n    gzip_buffers 4 8k;\n    #压缩文件最小大小\n    gzip_min_length 1k;\n    #压缩级别1-9\n    gzip_comp_level 9;\n    #给响应头加个vary，告知客户端能否缓存\n    gzip_vary on;\n    #反向代理时使用\n    gzip_proxied off;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);