<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>BLOG</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/vuepress/favicon.ico">
    <meta name="description" content="学习笔记">
    <link rel="preload" href="/vuepress/assets/css/0.styles.a1d845f0.css" as="style"><link rel="preload" href="/vuepress/assets/js/app.698edf64.js" as="script"><link rel="preload" href="/vuepress/assets/js/2.2ce5df5b.js" as="script"><link rel="preload" href="/vuepress/assets/js/26.3a75cf4e.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/10.09b2ea05.js"><link rel="prefetch" href="/vuepress/assets/js/11.c69ee5aa.js"><link rel="prefetch" href="/vuepress/assets/js/12.1f170326.js"><link rel="prefetch" href="/vuepress/assets/js/13.1883e67e.js"><link rel="prefetch" href="/vuepress/assets/js/14.55d29b4e.js"><link rel="prefetch" href="/vuepress/assets/js/15.b571d130.js"><link rel="prefetch" href="/vuepress/assets/js/16.cbf4423a.js"><link rel="prefetch" href="/vuepress/assets/js/17.0ecae00f.js"><link rel="prefetch" href="/vuepress/assets/js/18.8a452ec9.js"><link rel="prefetch" href="/vuepress/assets/js/19.0022a899.js"><link rel="prefetch" href="/vuepress/assets/js/20.e82790c5.js"><link rel="prefetch" href="/vuepress/assets/js/21.ef1a1af6.js"><link rel="prefetch" href="/vuepress/assets/js/22.c1aad3a2.js"><link rel="prefetch" href="/vuepress/assets/js/23.f403526b.js"><link rel="prefetch" href="/vuepress/assets/js/24.d3cc9450.js"><link rel="prefetch" href="/vuepress/assets/js/25.8f1830d8.js"><link rel="prefetch" href="/vuepress/assets/js/27.e3af81ba.js"><link rel="prefetch" href="/vuepress/assets/js/28.c1867c81.js"><link rel="prefetch" href="/vuepress/assets/js/29.2ba9a3bd.js"><link rel="prefetch" href="/vuepress/assets/js/3.dfccb20d.js"><link rel="prefetch" href="/vuepress/assets/js/30.8ddcfe76.js"><link rel="prefetch" href="/vuepress/assets/js/31.7e828e57.js"><link rel="prefetch" href="/vuepress/assets/js/32.91359916.js"><link rel="prefetch" href="/vuepress/assets/js/33.b29c47e5.js"><link rel="prefetch" href="/vuepress/assets/js/34.4f154d4c.js"><link rel="prefetch" href="/vuepress/assets/js/35.25e2d8d4.js"><link rel="prefetch" href="/vuepress/assets/js/36.29df960a.js"><link rel="prefetch" href="/vuepress/assets/js/37.f9ec995f.js"><link rel="prefetch" href="/vuepress/assets/js/38.b100008f.js"><link rel="prefetch" href="/vuepress/assets/js/39.5794a728.js"><link rel="prefetch" href="/vuepress/assets/js/4.d599a372.js"><link rel="prefetch" href="/vuepress/assets/js/40.b4c2b4e9.js"><link rel="prefetch" href="/vuepress/assets/js/41.b79940a3.js"><link rel="prefetch" href="/vuepress/assets/js/42.48670cce.js"><link rel="prefetch" href="/vuepress/assets/js/43.9251067b.js"><link rel="prefetch" href="/vuepress/assets/js/44.d9be37b6.js"><link rel="prefetch" href="/vuepress/assets/js/45.e3dee9cd.js"><link rel="prefetch" href="/vuepress/assets/js/5.525c50d0.js"><link rel="prefetch" href="/vuepress/assets/js/6.386e2672.js"><link rel="prefetch" href="/vuepress/assets/js/7.d4dd4b8a.js"><link rel="prefetch" href="/vuepress/assets/js/8.f7bedf91.js"><link rel="prefetch" href="/vuepress/assets/js/9.721f3546.js">
    <link rel="stylesheet" href="/vuepress/assets/css/0.styles.a1d845f0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress/" class="home-link router-link-active"><!----> <span class="site-name">BLOG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端学习笔记" class="dropdown-title"><span class="title">前端学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端学习笔记" class="mobile-dropdown-title"><span class="title">前端学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress/front-end/evo/优化方式.html" class="nav-link">
  前端优化
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/front-end/js/es6知识.html" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/front-end/vue/vue知识点.html" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/front-end/webpack/webpack基础.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/front-end/net/网络基础.html" class="nav-link">
  网络基础
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/front-end/tools/GIT.html" class="nav-link">
  开发工具
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/front-end/ci/travis自动部署.html" class="nav-link">
  前端自动化
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后台学习笔记" class="dropdown-title"><span class="title">后台学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="后台学习笔记" class="mobile-dropdown-title"><span class="title">后台学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress/back-end/node/express.html" class="nav-link">
  NodeJS
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/back-end/lib-web/RESTful.html" class="nav-link">
  web开发知识
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/back-end/server/Nginx.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  服务器
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JustDoIT" class="dropdown-title"><span class="title">JustDoIT</span> <span class="arrow down"></span></button> <button type="button" aria-label="JustDoIT" class="mobile-dropdown-title"><span class="title">JustDoIT</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress/funs/hardware/arduino.html" class="nav-link">
  硬件
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端学习笔记" class="dropdown-title"><span class="title">前端学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端学习笔记" class="mobile-dropdown-title"><span class="title">前端学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress/front-end/evo/优化方式.html" class="nav-link">
  前端优化
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/front-end/js/es6知识.html" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/front-end/vue/vue知识点.html" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/front-end/webpack/webpack基础.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/front-end/net/网络基础.html" class="nav-link">
  网络基础
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/front-end/tools/GIT.html" class="nav-link">
  开发工具
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/front-end/ci/travis自动部署.html" class="nav-link">
  前端自动化
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后台学习笔记" class="dropdown-title"><span class="title">后台学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="后台学习笔记" class="mobile-dropdown-title"><span class="title">后台学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress/back-end/node/express.html" class="nav-link">
  NodeJS
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/back-end/lib-web/RESTful.html" class="nav-link">
  web开发知识
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/back-end/server/Nginx.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  服务器
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JustDoIT" class="dropdown-title"><span class="title">JustDoIT</span> <span class="arrow down"></span></button> <button type="button" aria-label="JustDoIT" class="mobile-dropdown-title"><span class="title">JustDoIT</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress/funs/hardware/arduino.html" class="nav-link">
  硬件
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>服务器</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress/back-end/server/Nginx.html" aria-current="page" class="active sidebar-link">Nginx</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress/back-end/server/Nginx.html#nignx" class="sidebar-link">Nignx</a></li><li class="sidebar-sub-header"><a href="/vuepress/back-end/server/Nginx.html#web-服务器" class="sidebar-link">web 服务器</a></li><li class="sidebar-sub-header"><a href="/vuepress/back-end/server/Nginx.html#nginx-使用" class="sidebar-link">Nginx 使用</a></li><li class="sidebar-sub-header"><a href="/vuepress/back-end/server/Nginx.html#location-详解" class="sidebar-link">location 详解</a></li><li class="sidebar-sub-header"><a href="/vuepress/back-end/server/Nginx.html#常用命令" class="sidebar-link">常用命令</a></li><li class="sidebar-sub-header"><a href="/vuepress/back-end/server/Nginx.html#nginx-配置-gzip-压缩" class="sidebar-link">nginx 配置 gzip 压缩</a></li></ul></li><li><a href="/vuepress/back-end/server/ali-ecs.html" class="sidebar-link">云服务器&amp;CentOS</a></li><li><a href="/vuepress/back-end/server/linux基础.html" class="sidebar-link">Linux基础</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>前言，最近项目用到了 Nginx 做反向代理，顺便记录一篇博文。</p> <h2 id="nignx"><a href="#nignx" class="header-anchor">#</a> Nignx</h2> <p>Nginx 同 Apache 一样都是一种 Web 服务器，但其轻量级的体积，及高并发等特点广受好评;</p> <h3 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h3> <ol><li><p><strong>性能方面</strong></p> <p>Nginx 是专门为性能优化而开发的，实现上非常注重效率。</p> <p>它采用内核 Poll 模型，可以支持更多的并发连接，最大可以支持对 5 万个并发连接数的响应，而且只占用很低的内存资源。</p></li> <li><p><strong>稳定性方面</strong></p> <p>Nginx 采取了分阶段资源分配技术，使得 CPU 与内存的占用率非常低。</p> <p>Nginx 官方表示，Nginx 保持 1 万个没有活动的连接，而这些连接只占用 2.5MB 内存，</p> <p>因此，类似 DOS 这样的攻击对 Nginx 来说基本上是没有任何作用的。</p></li> <li><p><strong>高可用性方面</strong></p> <p>Nginx 支持热部署，启动速度特别迅速，因此可以在不间断服务的情况下，对软件版本或者配置进行升级，</p> <p>即使运行数月也无需重新启动，几乎可以做到 7x24 小时不间断地运行。</p></li> <li><p><strong>效率方面</strong></p> <p>作为 Web 服务器，Nginx 处理静态文件、索引文件，自动索引的效率非常高。</p></li></ol> <h2 id="web-服务器"><a href="#web-服务器" class="header-anchor">#</a> web 服务器</h2> <p>说到这个名字了，简单说一下定义：</p> <blockquote><p>当我们使用 PC 并通过浏览器查看网站时，页面访问到的服务器都是我们都可称之为 Web 服务器。</p></blockquote> <h3 id="那-web-服务器做了什么呢"><a href="#那-web-服务器做了什么呢" class="header-anchor">#</a> 那 web 服务器做了什么呢？</h3> <p>再等一下（。。估计看文的大家心想，我就是想看看 nignx 是什么，怎么牵扯出了这么多东西），</p> <p>了解 web 服务器做了什么之前，我们先说一下使用浏览器访问页面是怎么一个流程；</p> <ol><li>用户使用浏览器，输入想要访问的网址（<strong>域名</strong>：例如<code>http://www.baidu.com</code>）；</li> <li>浏览器访问<strong>DNS</strong>服务器，查询得到域名对应的<strong>IP</strong>；</li> <li>浏览器通过<strong>IP</strong>，向<strong>web 服务器</strong>发送资源请求； （注意这里 web 服务器登场了）</li> <li><strong>web 服务器</strong>根据请求，向<strong>计算机</strong>获取所需资源；</li> <li><strong>web 服务器</strong>将获取到的资源返回给浏览器；</li> <li><strong>浏览器</strong>接收到返回的资源（例如 HTML），<strong>解析</strong>成页面，展示给用户；</li></ol> <p>那 web 服务器到底做什么了？</p> <p>一般 web 服务器都会有配置映射文件地址，也就是文件路径和 URL 的关系映射；</p> <p>我们看第 4 步，web 服务器接到请求<code>URL</code>后，解析<code>URL</code>字符串；</p> <p>通过解析得到的<code>URL</code>，拿到映射的文件路径，在计算器磁盘中就可以获取静态资源，然后将资源返回给浏览器；</p> <p>所以 web 服务器就是做了<strong>静态资源分配</strong>这个事，供外界远程访问；</p> <p>也是 web 服务器最常用的场景。</p> <p>严格意义上 web 服务器只负责处理<code>http</code>协议，管理静态资源，其他内容都<strong>转交</strong>给其他应用服务器来做；</p> <p>怎么转交呢？</p> <p>那么就是使用 Nignx 的<strong>反向代理</strong>功能了，这也就是 Nignx 常见的使用方式；</p> <h3 id="常见的-web-服务器有哪些呢"><a href="#常见的-web-服务器有哪些呢" class="header-anchor">#</a> 常见的 web 服务器有哪些呢？</h3> <p>Nginx、Apache、Lighttpd 等等很多；</p> <h2 id="nginx-使用"><a href="#nginx-使用" class="header-anchor">#</a> Nginx 使用</h2> <p>了解 Nginx 是什么后，那么赶紧说一下怎么使用吧。</p> <p>分为三步：</p> <p>1.下载安装</p> <p>到官网直接下载 windows 版就可以了，解压即可；</p> <p>2.运行 Nignx</p> <p>使用 CMD 进入到解压目录，命令<code>start nginx</code>看到一个窗口闪现，nginx 就成功启动了！</p> <p>是不是很简单...：|</p> <p>3.验证</p> <p>浏览器打开<code>lacalhost:80</code>，如果显示 nginx 欢迎页，则表示启动成功；</p> <p>到这里 Nginx 已经 ok 了！</p> <p>接下来就告诉他，怎么让它变成一个成熟的 nginx，承担起上面提到<strong>web 服务器</strong>的责任吧</p> <h3 id="静态资源托管"><a href="#静态资源托管" class="header-anchor">#</a> 静态资源托管</h3> <p>上面也说了浏览器获取网页的步骤，那么当浏览器发送请求给 web 服务器的时候，我们现在手握 nginx 应该怎么办呢？</p> <p><strong>配置代理映射</strong>即可！</p> <p>打开 nginx 解压路径<code>nginx-1.9.9\conf\nginx.conf</code>这个<strong>配置文件</strong>；</p> <p>这个文件就是 ngnix 的配置文件，所有你需要的功能配置，都在这个文件里搞定；</p> <p>打开到 35 行左右，会发现下面这段代码，这里就主要配置的内容了：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>server {
        listen       80;               // nginx服务端口
        server_name  localhost;

        #charset koi8-r;

        #access_log  logs/host.access.log  main;

        location / {
            root   html;                         // 现在映射的资源是默认的nginx欢迎页（相对路径）
            index  index.html index.htm;      // 这里index表示默认文件，nginx会优先从这些文件里匹配
        }
		...
		...
		...
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>这里举个栗子，</p> <p>如果我们要实现图片资源的访问，浏览器输入<code>location:80/public/cake.jpg</code>，</p> <p>希望获取到电脑上想要的<code>E:/nginx-1.12.9/static/cake.jpg</code>这张图片时；</p> <p>那我们用 location 来匹配文件映射即可， 上代码：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>server {
        listen       80;               // nginx服务端口
        server_name  localhost;

        #charset koi8-r;

        #access_log  logs/host.access.log  main;

        location / {
            root   html;
            index  index.html index.htm;
        }

		location /public {
            alias   E:/nginx-1.12.9/static/;   //alias表示将location映射到的路径替换
		   autoindex on;                 //表示可以访问目录，显示文件列表（类似ftp）
        }
		...
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>通过这个配置就可以实现浏览器输入的 URL 虽然是<code>location:80/public/cake.jpg</code>，</p> <p>但我们的 web 服务器 nginx 收到后，将其中的<code>public</code>替换为<code>E:/nginx-1.12.9/static/</code>，</p> <p>所以最终指向了文件路径<code>E:/nginx-1.12.9/static/cake.jpg</code>；</p> <p>这样就实现了<strong>web 服务器</strong>的静态资源托管！</p> <h3 id="配置属性"><a href="#配置属性" class="header-anchor">#</a> 配置属性</h3> <p>这里在说明一下 location 中常用的一些配置属性；</p> <ol><li><h3 id="root-和-alias-设置静态资源根目录"><a href="#root-和-alias-设置静态资源根目录" class="header-anchor">#</a> root 和 alias === 设置静态资源根目录</h3> <blockquote><p>这两个常用来访问文件系统；</p></blockquote> <p>alias：表示直接替换掉 location 指定的 url；</p> <p>​ <strong>需要注意 alias 指定的 url，结尾要以<code>/</code>结尾！否则会出现无法匹配</strong></p> <p>root：表示将新路径拼接到 location 之前</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>例如:
location /public {
      root E:/nginx-1.12.9/static/;  // 这里的最终映射URL为 E:/nginx-1.12.9/static/public
      index  index.html index.htm;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><h3 id="autoindex-访问目录时列出文件列表"><a href="#autoindex-访问目录时列出文件列表" class="header-anchor">#</a> autoindex === 访问目录时列出文件列表</h3> <p>设置后，该地址打开会生成目录页面，类似于 ftp 服务；</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>location /public {
      root E:/nginx-1.12.9/static/;
      autoindex on;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><h3 id="index-优先匹配文件"><a href="#index-优先匹配文件" class="header-anchor">#</a> index === 优先匹配文件</h3> <p>这里设置的文件，如果访问的是目录文件夹地址，nginx 会优先匹配指定文件，如果匹配到，则直接展示；</p></li> <li><h3 id="proxy-pass-反向代理配置"><a href="#proxy-pass-反向代理配置" class="header-anchor">#</a> proxy_pass === 反向代理配置</h3> <blockquote><p>常用于代理请求，适用于前后端负载分离或多台机器、服务器负载分离的场景；</p> <p>例如，服务器上部署了配置的静态资源映射，用来访问主页 HTML，</p> <p>HTML 中的请求，我们使用反向代理来配置到指定的服务 serve 上；</p></blockquote> <p>例如实际请求为：<code>http://192.168.0.1/api/get_list</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>(1).
location /api/ {
    proxy_pass http://127.0.0.1:8080; // 结尾不加'/'，最终URL为： http://127.0.0.1:8080/api/list
}

(2).
location /api/ {
    proxy_pass http://127.0.0.1:8080/; // 结尾加'/'，最终URL为： http://127.0.0.1:8080/list
}

(3).
location /api/ {
    proxy_pass http://127.0.0.1:8080/test/;
}
// 结尾加'/'，最终URL为： http://127.0.0.1:8080/test/get_list

(4).
location /api/ {
    proxy_pass http://127.0.0.1:8080/test;
}
// 结尾加'/'，最终URL为： http://127.0.0.1:8080/testget_list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div></li></ol> <p>这样就配置好了基础的 web 服务器，实现了基本功能；</p> <p>虽然 web 服务器的作用很简单，目的也很明确，就是管理静态资源；</p> <p>但 nginx 能做的显然不止这么点，无论是反向代理负载均衡、gzip 压缩、跨域设置等等很多功能都可以简单做到；</p> <p>实现方式都是在配置文件中设置，碍于篇幅，暂不赘述了。先把 nginx 用起来吧~ ：)</p> <h2 id="location-详解"><a href="#location-详解" class="header-anchor">#</a> location 详解</h2> <p>location 语法规则很简单，一个<code>location</code>关键字，后面跟着可选的修饰符；</p> <p>最后是要匹配的字符，花括号中是要执行的操作。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>// location 修饰符 URL {执行内容}

location [ = | ~ | ~* | ^~ ] url {
	...
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="修饰符"><a href="#修饰符" class="header-anchor">#</a> 修饰符</h3> <ul><li><code>=</code> 表示精确匹配。只有请求的 url 路径与后面的字符串完全相等时，才会命中。</li> <li><code>~</code> 表示该规则是使用正则定义的，区分大小写。</li> <li><code>~*</code> 表示该规则是使用正则定义的，不区分大小写。</li> <li><code>^~</code> 表示如果该符号后面的字符是最佳匹配，采用该规则，不再进行后续的查找。</li></ul> <h3 id="匹配类型"><a href="#匹配类型" class="header-anchor">#</a> 匹配类型</h3> <p>从修饰符可以看出 location 有<strong>两种表示形式</strong>，</p> <ul><li><p>一种是使用前缀字符，也就是直接使用<code>URL</code>中的字符匹配；</p></li> <li><p>一种是使用正则。</p></li></ul> <p>所以如果是正则匹配的话，前面有<code>~</code>或<code>~*</code>修饰符。</p> <h3 id="匹配规则"><a href="#匹配规则" class="header-anchor">#</a> 匹配规则</h3> <p>可以先排一下匹配规则的<strong>优先程度</strong>；</p> <p>精准匹配 &gt; 正则匹配 &gt; 前缀字符匹配</p> <p>为什么这样认为呢？因为 Location 匹配顺序是这样：</p> <ol><li><p>首先先检查使用前缀字符定义的 location，选择最长匹配的项并记录下来。（这里并没有使用，只是记录暂存）</p></li> <li><p>如果找到了精确匹配的 location，也就是使用了<code>=</code>修饰符的 location，结束查找，使用它的配置。</p> <p>（这也就能说明精准匹配优先度最高，只要符合直接执行并结束）</p></li> <li><p>如果没有精准匹配，然后就按顺序查找使用正则定义的 location，</p> <p>如果匹配则停止查找，使用它定义的配置。 （这里就是正则优先程度居其次）</p></li> <li><p>最后如果没有匹配的任何正则 location，则使用前面记录的最长匹配前缀字符 location。</p> <p>（前缀字符匹配优先程度最低）</p></li></ol> <p>也需要注意的是，因为正则和精准匹配的特性，所以他们只要匹配后，就不会再往下查找；</p> <h2 id="常用命令"><a href="#常用命令" class="header-anchor">#</a> 常用命令</h2> <h3 id="linux-下"><a href="#linux-下" class="header-anchor">#</a> linux 下</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>启动Nginx服务

要启动Nginx服务，请运行以下命令。 请注意，如果配置语法不正确，此过程可能会失败。

$ sudo systemctl start nginx
或者
$ sudo service nginx start

启用Nginx服务

上一个命令仅在此期间启动服务，要在启动时启用它自动启动，请运行以下命令。

$ sudo systemctl enable nginx
或者
$ sudo service nginx enable

重启Nginx服务

要重新启动Nginx服务，将停止然后启动该服务的操作。

$ sudo systemctl restart nginx
或者
$ sudo service nginx restart

查看Nginx服务状态

您可以按如下方式检查Nginx服务的状态。 此命令显示有关服务的运行时状态信息。

$ sudo systemctl status nginx
或者
$ sudo service nginx status
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="nginx-配置-gzip-压缩"><a href="#nginx-配置-gzip-压缩" class="header-anchor">#</a> nginx 配置 gzip 压缩</h2> <p>【参考】: <code>https://blog.csdn.net/qq_15807277/article/details/91909372</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    #开启gzip压缩
    gzip on;
    #http的协议版本
    gzip_http_version 1.0;
    #IE版本1-6不支持gzip压缩，关闭
    gzip_disable 'MSIE[1-6].';
    #需要压缩的文件格式 text/html默认会压缩，不用添加
    gzip_types text/css text/javascript application/javascript;
    #设置压缩缓冲区大小，此处设置为4个8K内存作为压缩结果流缓存
    gzip_buffers 4 8k;
    #压缩文件最小大小
    gzip_min_length 1k;
    #压缩级别1-9
    gzip_comp_level 9;
    #给响应头加个vary，告知客户端能否缓存
    gzip_vary on;
    #反向代理时使用
    gzip_proxied off;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/vuepress/back-end/server/ali-ecs.html">
        云服务器&amp;CentOS
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vuepress/assets/js/app.698edf64.js" defer></script><script src="/vuepress/assets/js/2.2ce5df5b.js" defer></script><script src="/vuepress/assets/js/26.3a75cf4e.js" defer></script>
  </body>
</html>
