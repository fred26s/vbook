<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTTPS | BLOG</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/vbook/favicon.ico">
    <meta name="description" content="学习笔记">
    <link rel="preload" href="/vbook/assets/css/0.styles.e0606203.css" as="style"><link rel="preload" href="/vbook/assets/js/app.56a9a2ed.js" as="script"><link rel="preload" href="/vbook/assets/js/2.2ce5df5b.js" as="script"><link rel="preload" href="/vbook/assets/js/17.be4efc3d.js" as="script"><link rel="prefetch" href="/vbook/assets/js/10.09b2ea05.js"><link rel="prefetch" href="/vbook/assets/js/11.b33443e5.js"><link rel="prefetch" href="/vbook/assets/js/12.31280131.js"><link rel="prefetch" href="/vbook/assets/js/13.1ae03640.js"><link rel="prefetch" href="/vbook/assets/js/14.d41b2257.js"><link rel="prefetch" href="/vbook/assets/js/15.b571d130.js"><link rel="prefetch" href="/vbook/assets/js/16.8a84fe06.js"><link rel="prefetch" href="/vbook/assets/js/18.d449664b.js"><link rel="prefetch" href="/vbook/assets/js/19.8f8c2dff.js"><link rel="prefetch" href="/vbook/assets/js/20.5d3267da.js"><link rel="prefetch" href="/vbook/assets/js/21.a6523cdd.js"><link rel="prefetch" href="/vbook/assets/js/22.c640d9af.js"><link rel="prefetch" href="/vbook/assets/js/23.879bf70a.js"><link rel="prefetch" href="/vbook/assets/js/24.bd48ace9.js"><link rel="prefetch" href="/vbook/assets/js/25.0f12410b.js"><link rel="prefetch" href="/vbook/assets/js/26.718ccfa4.js"><link rel="prefetch" href="/vbook/assets/js/27.f153037d.js"><link rel="prefetch" href="/vbook/assets/js/28.508d01f9.js"><link rel="prefetch" href="/vbook/assets/js/29.dbe0222b.js"><link rel="prefetch" href="/vbook/assets/js/3.dfccb20d.js"><link rel="prefetch" href="/vbook/assets/js/30.9988d278.js"><link rel="prefetch" href="/vbook/assets/js/31.6008081f.js"><link rel="prefetch" href="/vbook/assets/js/32.6d16c0dd.js"><link rel="prefetch" href="/vbook/assets/js/33.e4e21daf.js"><link rel="prefetch" href="/vbook/assets/js/34.d37fab85.js"><link rel="prefetch" href="/vbook/assets/js/35.6f741ed5.js"><link rel="prefetch" href="/vbook/assets/js/36.58d8b589.js"><link rel="prefetch" href="/vbook/assets/js/37.674e27ab.js"><link rel="prefetch" href="/vbook/assets/js/38.fa018258.js"><link rel="prefetch" href="/vbook/assets/js/39.2f197b8d.js"><link rel="prefetch" href="/vbook/assets/js/4.d599a372.js"><link rel="prefetch" href="/vbook/assets/js/40.60890a66.js"><link rel="prefetch" href="/vbook/assets/js/41.99ac89f4.js"><link rel="prefetch" href="/vbook/assets/js/42.fc4ec52c.js"><link rel="prefetch" href="/vbook/assets/js/43.f3404978.js"><link rel="prefetch" href="/vbook/assets/js/44.98c5c2de.js"><link rel="prefetch" href="/vbook/assets/js/45.4f1b0703.js"><link rel="prefetch" href="/vbook/assets/js/46.ed7569c8.js"><link rel="prefetch" href="/vbook/assets/js/5.4413bd57.js"><link rel="prefetch" href="/vbook/assets/js/6.0afd5f60.js"><link rel="prefetch" href="/vbook/assets/js/7.61ee7893.js"><link rel="prefetch" href="/vbook/assets/js/8.aa2210e7.js"><link rel="prefetch" href="/vbook/assets/js/9.2be3499c.js">
    <link rel="stylesheet" href="/vbook/assets/css/0.styles.e0606203.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vbook/" class="home-link router-link-active"><!----> <span class="site-name">BLOG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端学习笔记" class="dropdown-title"><span class="title">前端学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端学习笔记" class="mobile-dropdown-title"><span class="title">前端学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vbook/front-end/evo/优化方式.html" class="nav-link">
  前端优化
</a></li><li class="dropdown-item"><!----> <a href="/vbook/front-end/js/es6知识.html" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/vbook/front-end/vue/vue知识点.html" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/vbook/front-end/webpack/webpack基础.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/vbook/front-end/net/网络基础.html" class="nav-link">
  网络基础
</a></li><li class="dropdown-item"><!----> <a href="/vbook/front-end/tools/GIT.html" class="nav-link">
  开发工具
</a></li><li class="dropdown-item"><!----> <a href="/vbook/front-end/ci/travis自动部署.html" class="nav-link">
  前端自动化
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后台学习笔记" class="dropdown-title"><span class="title">后台学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="后台学习笔记" class="mobile-dropdown-title"><span class="title">后台学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vbook/back-end/node/express.html" class="nav-link">
  NodeJS
</a></li><li class="dropdown-item"><!----> <a href="/vbook/back-end/lib-web/RESTful.html" class="nav-link">
  web开发知识
</a></li><li class="dropdown-item"><!----> <a href="/vbook/back-end/server/Nginx.html" class="nav-link">
  服务器
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JustDoIT" class="dropdown-title"><span class="title">JustDoIT</span> <span class="arrow down"></span></button> <button type="button" aria-label="JustDoIT" class="mobile-dropdown-title"><span class="title">JustDoIT</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vbook/funs/hardware/arduino.html" class="nav-link">
  硬件
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端学习笔记" class="dropdown-title"><span class="title">前端学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端学习笔记" class="mobile-dropdown-title"><span class="title">前端学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vbook/front-end/evo/优化方式.html" class="nav-link">
  前端优化
</a></li><li class="dropdown-item"><!----> <a href="/vbook/front-end/js/es6知识.html" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/vbook/front-end/vue/vue知识点.html" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/vbook/front-end/webpack/webpack基础.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/vbook/front-end/net/网络基础.html" class="nav-link">
  网络基础
</a></li><li class="dropdown-item"><!----> <a href="/vbook/front-end/tools/GIT.html" class="nav-link">
  开发工具
</a></li><li class="dropdown-item"><!----> <a href="/vbook/front-end/ci/travis自动部署.html" class="nav-link">
  前端自动化
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后台学习笔记" class="dropdown-title"><span class="title">后台学习笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="后台学习笔记" class="mobile-dropdown-title"><span class="title">后台学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vbook/back-end/node/express.html" class="nav-link">
  NodeJS
</a></li><li class="dropdown-item"><!----> <a href="/vbook/back-end/lib-web/RESTful.html" class="nav-link">
  web开发知识
</a></li><li class="dropdown-item"><!----> <a href="/vbook/back-end/server/Nginx.html" class="nav-link">
  服务器
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JustDoIT" class="dropdown-title"><span class="title">JustDoIT</span> <span class="arrow down"></span></button> <button type="button" aria-label="JustDoIT" class="mobile-dropdown-title"><span class="title">JustDoIT</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vbook/funs/hardware/arduino.html" class="nav-link">
  硬件
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>web开发知识</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vbook/back-end/lib-web/RESTful.html" class="sidebar-link">RESTful</a></li><li><a href="/vbook/back-end/lib-web/项目架构.html" class="sidebar-link">项目架构</a></li><li><a href="/vbook/back-end/lib-web/用户邮箱注册.html" class="sidebar-link">用户邮箱注册</a></li><li><a href="/vbook/back-end/lib-web/加密算法.html" class="sidebar-link">加密算法</a></li><li><a href="/vbook/back-end/lib-web/HTTPS.html" aria-current="page" class="active sidebar-link">HTTPS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vbook/back-end/lib-web/HTTPS.html#https" class="sidebar-link">HTTPS</a></li><li class="sidebar-sub-header"><a href="/vbook/back-end/lib-web/HTTPS.html#为什么要升级-https" class="sidebar-link">为什么要升级 HTTPS</a></li><li class="sidebar-sub-header"><a href="/vbook/back-end/lib-web/HTTPS.html#https-和-http-区别" class="sidebar-link">HTTPS 和 HTTP 区别</a></li><li class="sidebar-sub-header"><a href="/vbook/back-end/lib-web/HTTPS.html#https-做了什么" class="sidebar-link">HTTPS 做了什么</a></li><li class="sidebar-sub-header"><a href="/vbook/back-end/lib-web/HTTPS.html#初级加密-对称加密" class="sidebar-link">初级加密 - 对称加密</a></li><li class="sidebar-sub-header"><a href="/vbook/back-end/lib-web/HTTPS.html#非对称加密" class="sidebar-link">非对称加密</a></li><li class="sidebar-sub-header"><a href="/vbook/back-end/lib-web/HTTPS.html#非对称-对称-加密" class="sidebar-link">非对称+对称 加密</a></li><li class="sidebar-sub-header"><a href="/vbook/back-end/lib-web/HTTPS.html#最终的-https-形式" class="sidebar-link">最终的 HTTPS 形式</a></li><li class="sidebar-sub-header"><a href="/vbook/back-end/lib-web/HTTPS.html#hppts-in-nodejs" class="sidebar-link">HPPTS IN NODEJS</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="https"><a href="#https" class="header-anchor">#</a> HTTPS</h2> <h2 id="为什么要升级-https"><a href="#为什么要升级-https" class="header-anchor">#</a> 为什么要升级 HTTPS</h2> <p>因为 HTTP 协议是无状态的，并且在传输过程中是明文传输；这样就造成在传输过程中，在一些路由节点中很容易被别人捕获并实施篡改；</p> <p>所以升级成 HTTPS 更多的是为安全考虑，毕竟用户的账户密码都有可能在传输中被监听；</p> <h2 id="https-和-http-区别"><a href="#https-和-http-区别" class="header-anchor">#</a> HTTPS 和 HTTP 区别</h2> <p>HTTPS 全称（Hyper Text Transfer Protocol over SecureSocket Layer）也就是<strong>超文本传输安全协议</strong>；</p> <p>多出来的这个安全协议，本质上就是对原有协议中传输的数据进行了加密，来保证传输数据的安全；</p> <p>加密主要使用<code>HTTP + SSL / TLS</code>进行加密操作，加密过程中用到了：</p> <ul><li>非对称加密</li> <li>对称加密</li></ul> <h2 id="https-做了什么"><a href="#https-做了什么" class="header-anchor">#</a> HTTPS 做了什么</h2> <p>其实 HTTPS 就是针对 HTTP 协议做出的层层加强：</p> <ul><li><h2 id="初级加密-对称加密"><a href="#初级加密-对称加密" class="header-anchor">#</a> 初级加密 - 对称加密</h2> <p>如果 HTTP 协议是明文的，那我们可以提前告诉对方我们约定的秘钥，在传输数据前进行加密；</p> <p>对方收到后用约定的秘钥解密，即完成了 HTTP 协议的加密；</p> <h3 id="短板"><a href="#短板" class="header-anchor">#</a> 短板</h3> <p>但这种加密是不安全的，因为虽然数据进行了加密，但双方使用的是<strong>同一个秘钥</strong>，</p> <p>这样会造成如果发送秘钥时被截取泄露，那这种加密就等同虚设；</p></li> <li><h2 id="非对称加密"><a href="#非对称加密" class="header-anchor">#</a> 非对称加密</h2> <p>如果说对称加密容易被破解，那我们可以使用上面说过的<strong>非对称加密</strong>！</p> <p>传输方使用公钥加密，接收方使用私钥解密；</p> <h3 id="短板-2"><a href="#短板-2" class="header-anchor">#</a> 短板</h3> <p>这样虽然安全性相对得到了保证，但非对称加密（例如 RSA）<strong>效率较差</strong>，速度比较慢，不适合常规使用；</p> <p>如果网站全部使用这种解密，那么速度得不到保证；</p></li> <li><h2 id="非对称-对称-加密"><a href="#非对称-对称-加密" class="header-anchor">#</a> 非对称+对称 加密</h2> <p>为了解决速度和安全并重的问题，有人提出了 建立通讯之前先通过 RSA 加密一个对称秘钥，</p> <p>保证了秘钥没有被窃取后，可以让我们相信获取的秘钥的是安全的；</p> <p>之后的通讯中就使用秘钥进行效率较高的对称加密通信；</p> <p>这，也就是 HTTPS 的大致原型！但还是会有问题...</p> <h3 id="短板-3"><a href="#短板-3" class="header-anchor">#</a> 短板</h3> <p>问题的点就出在，我们此时是相信初始化时通过 RSA 获取到的秘钥是安全可相信的，所以开启了后续的通讯；</p> <p>但，如何能保证通过 RSA 获取到的秘钥就是你真正想要获取的呢？</p> <p>仔细想想，我们进行 RSA 加密前，需要先获取公钥；</p> <p>但如果在获取公钥时，我们的数据被截取篡改，我们使用的是其他人的公钥进行了加密，那别人就可以使用自己的私钥进行解密，并伪装是我们想要通讯方，后续的安全就没有了意义；</p> <p>这就叫做<strong>中间人攻击</strong>，在中间截取公钥，做一个前后转发，前后真实通讯方并不知情；</p></li></ul> <p>如何证明你通讯的人就是想要的通讯方呢？问题又回到了保护数据安全的问题；</p> <h2 id="最终的-https-形式"><a href="#最终的-https-形式" class="header-anchor">#</a> 最终的 HTTPS 形式</h2> <p>所以引出了最终的 HTTPS 形式：</p> <p>基于上述<code>非对称加密和对称加密</code>下的形式，因为担心公钥数据传输安全，现在不直接传输公钥了；</p> <p>我们找一个官方认证的组织（数字证书认证机构（Certificate Authority，缩写为 CA））；</p> <p>服务器将产生的公钥交给它，并进行登记相关的个人/公司、域名等信息；</p> <p>现在的流程就变成了：</p> <ol><li><p>初始化建立通讯时，serve 端发送证书给 client 端；</p></li> <li><p>client 拿到证书后，会向 CA 验证证书真实性，</p></li> <li><p>如果真实未被篡改，那么就可安全的使用证书中的公钥；</p> <p>进行后续的通讯操作（同上一步[非对称+对称]）</p> <p>如果证书存在问题，一般浏览器在操作系统中内置的一些顶级 CA 信息来验证，并发出提示。</p></li></ol> <h2 id="hppts-in-nodejs"><a href="#hppts-in-nodejs" class="header-anchor">#</a> HPPTS IN NODEJS</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>let express = require(&quot;express&quot;);
let http = require(&quot;http&quot;);
let https = require(&quot;https&quot;);
let fs = require(&quot;fs&quot;);
// Configuare https
const httpsOption = {
    key : fs.readFileSync(&quot;./https/xxxxxxxxxxxx.key&quot;),
    cert: fs.readFileSync(&quot;./https/xxxxxxxxxxxx.pem&quot;)
}
// Create service
let app = express();
http.createServer(app).listen(80);
https.createServer(httpsOption, app).listen(443);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vbook/back-end/lib-web/加密算法.html" class="prev">
        加密算法
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vbook/assets/js/app.56a9a2ed.js" defer></script><script src="/vbook/assets/js/2.2ce5df5b.js" defer></script><script src="/vbook/assets/js/17.be4efc3d.js" defer></script>
  </body>
</html>
