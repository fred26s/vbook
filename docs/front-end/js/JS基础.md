## 堆与栈

### 栈（stack）

栈的特点是**"LIFO，即后进先出（Last in, first out）"**。数据存储时只能从顶部逐个存入，取出时也需从顶部逐个取出。

比如一个乒乓球的盒子，先放进去（入栈）的乒乓球就只能后出来（出栈）。

### 堆（heap） 

堆的特点是**"无序"**的`key-value`**"键值对"**存储方式。
举个例子：书架存书

### 栈内存和堆内存存在原因 

**通常与垃圾回收机制有关。为了使程序运行时占用的内存最小。**

当一个方法执行时，每个方法都会建立自己的内存栈，在这个方法内定义的变量将会逐个放入这块栈内存里，随着方法的执行结束，这个方法的内存栈也将自然销毁了。

因此，**所有在方法中定义的变量都是放在栈内存中的；**

当我们在程序中创建一个对象时，这个对象将被保存到运行时数据区中，以便反复利用（因为对象的创建成本通常较大），这个运行时数据区就是堆内存。

**堆内存中的对象不会随方法的结束而销毁**，即使方法结束后，这个对象还可能被另一个引用变量所引用（方法的参数传递时很常见），则这个对象依然不会被销毁，只有当一个对象没有任何引用变量引用它时，系统的垃圾回收机制才会在核实的时候回收它。





## 垃圾回收机制

JavaScript中有自动垃圾回收机制，会通过标记清除的算法识别哪些变量对象不再使用，对其进行销毁。**开发者也可在代码中手动设置变量值为null（`a = null`）进行标记清除**，让其失去引用，以便下一次垃圾回收时进行有效回收。

局部环境中，函数执行完成后，函数局部环境声明的变量不再需要时，就会被垃圾回收销毁（理想的情况下，闭包会阻止这一过程）。

全局环境只有页面退出时才会出栈，解除变量引用。所以开发者应尽量避免在全局环境中创建全局变量，如需使用，也要在不需要时手动标记清除，将其内存释放掉。