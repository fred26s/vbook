[[toc]]



## 地图坐标系

###  WGS－84原始坐标系

WGS-84：是**国际标准**，GPS坐标（Google Earth使用、或者GPS模块）。

一般用国际GPS纪录仪记录下来的经纬度，**通过GPS定位拿到的原始经纬度**，Google和高德地图定位的的经纬度（国外）都是基于WGS－84坐标系的；但是在国内是不允许直接用WGS84坐标系标注的，必须经过加密后才能使用； 

### GCJ－02坐标系

又名**“火星坐标系”**，是我国国测局独创的坐标体系，**由WGS－84加密而成**，在国内，必须至少使用GCJ－02坐标系，或者使用在GCJ－02加密后再进行加密的坐标系，如百度坐标系。高德和Google在国内都是使用GCJ－02坐标系，可以说，GCJ－02是国内最广泛使用的坐标系； GCJ-02：中国坐标偏移标准，Google Map、高德、腾讯使用；

### 百度坐标系:bd-09

百度坐标系是**在GCJ－02坐标系的基础上再次加密偏移后形成的坐标系**，只适用于百度地图。(目前百度API提供了从其它坐标系转换为百度坐标系的API，但却没有从百度坐标系转为其他坐标系的API)； BD-09：百度坐标偏移标准，Baidu Map使用；

## GCJ-02的来源

这个GCJ-02加密存在的原因是因为有一个国家标准，名叫《导航电子地图安全处理技术基本要求》，标准号为GB 20263—2006。该标准的第4节第4.1款规定：

> **4.1　导航电子地图在公开出版、销售、传播、展示和使用前，必须进行空间位置技术处理。**

这个所谓的“**空间位置技术处理**”，就是把地图从GPS坐标使用的 WGS-84 坐标系，转换为“火星坐标系”。

转换后的偏差一般为 300~500 米。也就是说，你手机GPS获取的坐标，直接叠加到这个“火星坐标系”的地图上，会有 300~500 米的偏差。

### GCJ-02的作用/使用流程

以百度地图为例，通俗解释流程有如下。

1. 首先百度的导航地图供应商是四维图新

2. 四维图新在提供地图给百度之前，需要先提交给测绘局，测绘局用72行代码（类似的）对地图做**偏移加密**，加密地图的坐标系就变成了所谓的 GCJ-02 坐标系，也就是民间戏称的“火星坐标系”。

   当然，这个过程中，测绘局会顺便收点钱。

3. 百度收到四维图新的地图之后很容易发现，在这个地图上，GPS 位置会偏很远。

4. 没关系，百度再把地图软件拿到测绘局，请他们加入一个“保密插件”（还是那个72行代码），对GPS做同样的偏移。

   感谢测绘局，GPS位置又能和地图切合了。当然，这个“保密插件”还是要收费的。

加密作用：

> 从总体技术指标上看，美国具有最高水平，军商两用测绘卫星的空间分辨率达到0.31m，无地面控制点平面精度达到3.5m，高程精度达到米级。在卫星比例尺方面，从1:100000以上地形图发展到满足1:5000以下地形图制图。

这个“无地面控制点”的意思就是，人家根本不需要从中国出版的地图中获取地面控制点。因为这个3.5米的精度已经高于不加偏移的导航地图的精度。

这意味着从中国出版的导航地图中量取控制点丝毫不能提高精度，反而可能降低精度。更何况3.5米足以满足一些需要了。

所以...自行感受GCJ-02的作用......





## 插件概要

gcoord(geographic coordinates)是一个处理地理坐标系的js库，用来修正百度地图、高德地图及其它互联网地图坐标系不统一的问题.百度高德坐标偏移问题。

gcoord主要解决了两个问题：

1. 能将坐标在不同坐标系下相互转换
2. 能够处理GeoJSON，GeoJSON是地理行业一种通用的数据格式，它本质上就是JSON，不过对字段有一些约定。

[gcroord插件地址](https://github.com/hujiulong/gcoord)

```js
var result = gcoord.transform(
  [116.403988, 39.914266],    // 经纬度坐标
  gcoord.WGS84,               // 当前坐标系
  gcoord.BD09                 // 目标坐标系
);

console.log(result);  // [116.41661560068297, 39.92196580126834]
```





