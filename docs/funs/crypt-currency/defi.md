## DeFi

DeFi是**Decentralized Finance（去中心化金融）**的缩写，也被称做Open Finance。它实际是指用来构建开放式金融系统的去中心化协议，旨在让世界上任何一个人都可以随时随地进行金融活动。

在现有的金融系统中，金融服务主要由中央系统控制和调节，无论是最基本的存取转账、还是贷款或衍生品交易。DeFi则希望通过分布式开源协议允许用户以完全去中心化的方式成为贷方或借方，摆脱传统金融借贷繁琐的手续和纸质文件，无需中介，能够使个人可以完全控制自己的资金。

DeFi是基于开放的去中心化平台开发的一系列金融类应用，当前几乎全部的DeFi项目都在**以太坊**的区块链上进行。

## 优势

相比传统的中心化金融系统，这些DeFi平台具有三大优势：

1. 有资产管理需求的个人无需信任任何中介机构新的信任在机器和代码上重建；
2. 任何人都有访问权限，没人有中央控制权；
3. 所有协议都是开源的，因此任何人都可以在协议上合作构建新的金融产品，并在网络效应下加速金融创新。

## 风险

1. 代码漏洞风险；
2. 系统性风险，无论是传统金融还是可编程式金融，一定要思考到系统性风险，比如面临极端的行情波动时，DeFi生态是否能承载;

## 概念/名词

- TVL

  TVL是总体价值锁定的意思，它能够衡量在DeFi借贷和其他类型的货币市场中锁定了多少加密货币。

  从某种意义上说，TVL可以代表流动性资金池中的总流动性。它是衡量DeFi健康状况和整个流动性挖矿市场十分有效的指标。它也是比较不同DeFi协议的“市场份额”的有效指标。追踪TVL变化的好方法是使用Defi Pulse，可以通过它来查看哪一个DeFi平台上锁定了的最高数量的ETH或其他加密资产，这可以大致了解当前市场的流动性挖矿状态。

  当然，锁定的价值越多，在进行的流动性挖矿就越多，需要注意的是，可以用ETH、USD甚至BTC来衡量TVL。
  
- ICO：

  理解为币圈众筹就可以了，也就是有个团队想要进行基于区块链的创业，但是没有钱，所以他们就对币市的那些投资者说，我们团队牛逼呀，梦想着改变世界，但现在没有钱，投资我们吧，以后项目做起来了，大家都好，觉得他们做的事情靠谱的就给钱，然后创业团队就给一个币，作为投资了他们的凭证，这就是ico。

- 私募：

  币圈和证券市场都有私募，证券市场里的私募是指针对特定的人群的投资机构， 一般来说私募产品都是100万起，币圈里的私募没啥限制，更像是一个代投的中介。

- 公募：

  就是像广发基金、招商基金、华夏基金此类的。
  
- LP：

  LP主要是指提供流動性做市商的憑證，在Uniswap上一般用uni-v2，在Sushiswap上用的SLP，這兩個其實是DEX去中心化交易系統給做市商發的做市Token，也可以理解為某個代幣的股權份額。可以通過質押這些憑證在其他流動性挖礦項目上獲得激勵。

## 项目

DeFi类似于乐高积木，将一些基础的金融模块，有不同的智能合约来实现。

在这些智能合约之间相互调用，就把一些金融功能拼在一起，“有人提供像Compound这样的借贷，有人（uniswa）提供去中心化的交易所，有人提供监控抵押品充足情况的机制”。

### 借贷类

- ### P2P 撮合模式

  Dharma 和 dYdX 都是撮合借方和贷方的点对点协议。因此，基于这两个协议的贷款和借款数量是相等的。

  如，Dharma 中由智能合约充当“担保方”角色，评估借方的资产价格和风险。债权人则根据“担保方”提供的评估结果决定是否贷款给借款人，同时当借款人无法按时还款时，“担保方”自动执行清算程序。Dharma 平台的借款期限最长为 90 天，贷款利息是固定的。贷款人在放贷期间资金被锁定，只有在与借款人匹配后才开始赚取利息。

  dYdX 协议也是 P2P 模式，但它与其他借贷平台之间的主要区别是，dYdX 也支持除了借入借出之外的其他交易，如期货交易。交易者在 dYdX 开仓时，会借入保证金，并与贷方通过平台就条款协议达成一致，进行保证金交易。所以 dYdX 的目标客户主要是保证金交易商。dYdX 平台的利息是可变的，用户在 dYdX 上贷款时没有锁定期或最长期限。

- ### 流动池交易

  以 Compound 为例，借方和贷方通过流动性交易池进行交易，而不是与交易对手进行匹配。

  每个贷款和借款的利率由池子的流动性大小来确定，即由贷方提供的货币总数量和借方的需求总数量之间的比率而波动。

  Compound 不设置固定的贷款期限，贷款人可以把资金存入贷款池子持续赚取利息，并随时提取资产。借款人有无限的合约期。

  ### 利息逻辑

  一个用户向Compound存入10 ETH。为了换取10个ETH，Compound会发行cTokens来作为等值抵押物；

  1. 用户存入ETH，得到等值的CToken；

     获得Ctoken的数量取决于取决于该ETH市场当前的**汇率**，例如汇率为 1ETH = 0.2CToken;

  2. 用户存入1ETH，得到5CToken;

  3. 当用户想赎回自己的ETH时，需要使用CToken（这就赋予了ctoken价值，并且作为ERC20代币可以转移）;

     赎回的ETH = 本金 + 利息；

     这里的利息来源就是汇率的变动，根据你存入的时间汇率会增加，也就是说经过一段时间赎回时汇率已经增长到了0.25；

     那么5token*0.25 = 1.25ETH ，你用5CToken就可以换回1.25ETH，多出的0.25ETH就是利息。

  > #### compound
  >
  > Compound是目前DeFi借贷市场上主流的以太坊借贷平台之一，成立于2018年9月，并在2019年11月从各风险投资公司筹集资金2500万美元。
  >
  > Compound支持8种代币ETH、USDC、DAI、REP、WBTC、SAI、ZRX和BAT的借贷，用户可以通过抵押一种代币借出另一种代币。
  >
  > Compound本质上是拥有一种资产的人可以借入另一种资产的市场，与点对点借贷市场有根本区别，更像是传统的银行揽储和放贷的模式；这种模式对流动性带来的一个潜在风险是当资金使用率达到很高的水平时，存款用户的提现会无法全部兑付；
  >
  > Compound生态中用户持有资产可以存入获得利息，也可以参与借款合约违约后的资产折扣清算收益，也可以抵押一种资产借入另一种资产。
  >
  > 
  >
  > #### Aave
  >
  > [官网地址](https://aave.com/)
  >
  > Aave最重要也最不可或缺的产品是Aave协议，该协议于2020年1月发布。
  >
  > 它由ETHLend转变而来，从去中心化的P2P借贷转向资金池策略，也是Aave公司战略的重大转变。Aave协议是一种开源的非托管协议，允许用户在以太坊区块链上创建自己的去中心化货币市场。
  >
  > 
  >
  > 

  

- ### 稳定币模式

  这一模式的典型是 MakerDAO，没有贷方只有借方，且唯一可借入的资产是 DAI。

  借款人通过抵押数字资产（现为 ETH）借入新创造的 DAI。DAI 是 MakerDAO 平台发行的、与美元挂钩的稳定币。质押资产和借款的质押比率必须保持在 150% 以上。而其利息是全球性的，由 MKR 持有者通过投票来决定。利息并不稳定，曾在一个多月的时间里从 2.5% 上升到 19.5%。

  > #### makerDAO
  >
  > MakerDao生态中有两种代币，分别是DAI和MKR。
  >
  > - **DAI，**DAI由加密资产及真实资产抵押发行，1DAI=1美元，是目前最大的去中心化稳定币，市值超过10亿美元。
  >
  >   **在MakerDao平台中，用户可以选择超额抵押加密资产生成稳定币DAI。以价值1000美元的ETH为例，DAI的发行流程基本如下：**
  >
  >   - 向智能合约存入价值1000美元的ETH作为抵押物；
  >   - 根据不同资产的抵押率，借出DAI的数量也不同。以太坊最低抵押率为150%，假设借贷人借出价值500美元的DAI，则抵押率为200%，当以太坊价值跌破750美元时，抵押物将被触发清算。
  >   - 归还借出的DAI，此时抵押自动解除，ETH自动存入借贷人的账户内。
  >
  > - **MKR，**生态中的治理代币，持有MKR可以参与投票、发起提案等。
  >
  >   1. **管理：**[MKR](https://www.bixiaobao.com/cn/coinlist/Maker)的持有者可以参与增加新的抵押债仓种类、修改已有抵押债仓种类、修改敏感参数、修改目标价变化率、选择可信任的预言机、调整喂价敏感度和选择全局清算者七个风险系统行为投票。
  >
  >   2. **权益：**在用户赎回抵押的以太坊时，需要支付 MKR 作为稳定费，这种情况下MKR 会被销毁。随着使用Dai的人越来越多，稳定费也会越来越多，销毁的MKR也就越来越多，MKR也就越来越值钱。从这个意义上讲，可以把MKR看作一个通缩体系，MKR的持有者可以从Dai的广泛使用中获取收益。
  >
  >      在这种情况下，MKR的持币者成为了最后系统的兜底者。MKR的持有者享受系统成长的收益，同时也要承担系统崩溃的风险。
  >
  >   MKR风险：
  >
  >   1. 如果抵押物价格短时间内暴跌，下跌至清算比例之下，抵押资产无法支撑 Dai的流通量时。
  >
  >      系统将会没收资产并进行拍卖，以偿还之前借出的 Dai（对于系统而言，每发行一枚 Dai就意味着负债一枚 Dai）。
  >
  >      系统开始增发 MKR ，并售卖 MKR 购买 Dai。而后，系统以公开竞卖的方式出售抵押资产，并用筹集的 Dai用于回购和销毁 MKR。
  >
  >      在这种情况下，MKR的持币者成为了最后系统的兜底者。MKR的持有者享受系统成长的收益，同时也要承担系统崩溃的风险。
  >









### 自动做市商AMM

自动化做市商的核心价值在于：通过算法创造了市场。

自动做市商的出现，让中心化交易所的模式有了替代品，用户跟用户之间无需中间商托管资产，即可实现点对点的数字资产交易。

**去中心化交易所、自动化做市商和资金流动池** (Liquid Pool) 协议的出现就是为了打破中心化交易所的垄断，例如动辄索要一百万美元上币费的情况；

运行模式：

> 目前常见的模式是逐渐加入代币，让用户自己对项目实现治理。目前 Balancer 代币价格较高，这意味着考虑到风险因素之后，成为 Balancer 的 LP 仍然有利可图。然而随着币价下跌， 如果平台的交易量不足以创建足够的利润，持续时间就难以为继了。
>
> 如果趋势无法持续，流动性提供者的激励不足，就可能会离开平台。当然有人也会有不同的看法。由于 AMM 平台的激励与个人在激励池中所占的比例有关，所以随着其他人的离开，余下参与者的收益会上涨。Balancer 代币回报的数额增加，也会让 LP 留下来。

#### uniswap

uniswap提供了即时兑换的方式，让用户可以在不同的代币之间进行交易，无需对手方，交易可以立即成交。

在Uniswap的做市商模式中，其流动性池涉及到两种代币，在提供流动性时，流动性提供者须将各50%价值比例的代币注入到流动性池。 

在Uniswap中兑换代币，本质上就是往流动性池中注入一种代币，同时提取另外一种代币，其流动性池是恒定乘积。

> 例如：
>
> 由流动性提供商向流动性池提供代币对，其价值比例为1:1，
>
> **也就是说，比如你提供100个MKR，同时需要提供221个ETH来做市**

#### Balancer

Balancer的通用化是指，将池中的代币，从2个增加为多个（目前Balancer最高可以设置为8个），将各50%的比重改为完全自定义的比例，

也就是说，在ETH-MKR的池中，不再限定为必须各注入50%价值比例的相应代币，Balancer而是注入用户自定义比例价值的代币，

这意味着如果有人持有 X 代币，想要提供流动性给 ETH，可以创建一个流通池，其中 80% 的代币是 X，20% 的代币是 ETH。

无需中心化交易所，就可以让小币种提供流动性机制更为容易。

> 例如可以注入75%的MKR和25%的ETH。当然，如果用户将代币设定为2个，一个是ETH，一个是MKR，比例为1:1，那么这跟Uniswap上的相应代币池没有区别，当然交易费也可以设定为0.3%。





## 预言机

预言机对区块链非常重要，现在的区块链发展还离不开预言机，抗攻击性是预言机最重要的特性。从发展来看，数据需求方可能会选择多个预言机来保证数据安全。

- **chainlink**

  Chainlink 通过节点声誉、抵押代币来保证数据安全，Chainlink 会对节点的工作进行声誉评价，声誉更好的节点更有可能获得数据需求方的选择。

  数据需求方可以设定节点是否需要抵押代币，以及抵押代币的数量及模式，理论上抵押的代币越多安全性越高。

  Chainlink 的报价节点要经过考核才能成为正式节点，Chainlink 会确认节点的身份以防止女巫攻击，以及作为对节点的约束，Chainlink 还公布了 15 个经过官方认证节点。

  数据需求方可以选择机构节点提供服务，机构节点本身有较高的信誉度，串联造假的信誉成本较高，可以认为安全性相对更高。

  #### 风险点：

  随着服务业务规模的增长，节点造假获得的潜在收益越来越高，预言机的安全性会逐步降低。

- **Band** 

  Band 是一个受到币安和红杉投资的的去中心化预言机协议。Band 认为预言机的难点在于如何通过经济模型设计实现真正可靠的去中心化，所以 Band 协议的不同之处就在于其经济模型。

  Band 协议内有众多数据集，每个数据集都有对应的代币，数据集代币通过代币池与协议代币 BAND 兑换获得。数据提供者需要抵押数据集代币，数据集代币持有者会对数据提供者进行投票，排名前几的节点才能成为数据提供者。

  Band 协议内还有协调者，协调者收集数据提供者提交的数据进行聚合，然后将聚合后的数据发送给数据集内的节点签名，签名比例达到 2/3 以上，协调者会将数据上传到链上，供数据需求方调用。

  完成了数据提供，系统会对数据提供者和投票者奖励数据集代币，奖励会大部分分给数据提供者。

  从官网公布的合作节点来看，也都是一些知名机构，从源头上提升了可信度。

  #### 风险点：

  Band 和 Chainlink 的风险点类似，随着服务规模的扩大，安全性会逐步降低。













## 流动性挖矿

首先要了解什么是**流动性**；

这里的流动性，主要指「资金的流动性」，即在不导致市场资产价格急剧变化的情况下，在市场中买卖资产的能力。

流动性的重要性？

资金的流动性是经济系统流动性的主要组成部分。稳定的资金流动性能够促进整个经济系统的稳定，使得经济系统具有一定的弹性，在一定程度上抵抗来自外界的不良冲击。

从定义中可以看出，市场的流动性是否良好，可以从四个维度进行衡量：

1. 交易速度。交易完成的速度越快，市场的流动性越好。
2. 交易价格。交易完成的价格越接近「公允价格」或「主导价格」，也就是我们常说的「滑点」越小，流动性越好。
3. 交易深度。交易深度可用来衡量市场的价格稳定程度。深度越大，一定数量的交易对价格的冲击越小。
4. 交易弹性。弹性，就是一定数量的交易导致价格偏离均衡水平后，恢复到「公允价格」的速度。流动性越好，价格恢复的速度越快。

再说**挖矿**：

挖矿的定义最初来源于比特币。简单的说，挖矿是在在一段时间内，通过解决特定的数学问题赢取记账权和相应奖励，对系统中发生的交易进行确认，并将其记录在区块链上形成新区块的过程。

从定义可以看出，挖矿有两个核心作用。

1. 代币分发。对于一个独立完整的金融系统，系统货币的分发，也就是「发给谁」，「发多少」和「怎么发」，是首先需要解决的问题。因此，琳琅满目的 IXO，本质上都是项目方为了解决这些问题而提出的挖矿分配方案。
2. 价值锚定和捕获。代币最初并无价值，通过挖矿，可以为代币附加简单的「投入-产出」比率，最终完成价值的锚定和捕获。例如，POW 机制的框架下，矿工通过投资算力和运维，换取区块奖励并在二级市场参与交易，从而有了「关机价格」的概念。

因此，挖矿的过程，就是代币分发并获取锚定价格的过程。

**所以，什么叫「流动性挖矿」？**

DeFi 领域的「流动性挖矿」，是指**通过具有挖矿机制的 DeFi 产品，按照要求存入或者借出指定的代币资产，为产品的资金池提供流动性而获取收益的过程**。

该收益可能是项目的原生代币，或者是其代表的治理权利。

以最近很火的 Compound 项目举例。作为基于以太坊的 DeFi 协议，Compound 的主要业务为抵押借贷。

根据 DefiPulse 的数据，7 月 7 日 Compound 的锁仓金额约为 6.5 亿美元。

用户可以将自己的资产进行抵押而获得年化收益，也可以支付相应的利息来借出资产，而在借款和贷款的同时，可以获取一定数量的系统分发的治理代币 COMP。按照设计，COMP 的持有者可以对 Compound 协议提出变更提案，或对提案进行投票。

**「挖矿要趁早」**

原力协议 CEO 雷宇表示，技术流和比较聪明的玩家，更容易从早期的 DeFi 项目中赚钱。

以太坊创始人 Vitalik 也宣称，从长远来看，DeFi 的利率绝对不会比传统金融的最高水平高出一个百分点以上。

**代币的升值不是终点，与现实世界的对接才是关键**

二级市场的繁荣不会永远持续，只有能够解决现实问题的 DeFi 项目，才是有价值的。





### [流动性挖矿的无偿损失](https://academy.binance.com/zh/articles/impermanent-loss-explained)

## 美股交易

[如何在uniswap交易](https://www.mdeditor.tw/pl/gbKE/zh-hk)



[DEFI介绍](https://www.liandufin.top/rate/kp/k2045.html)



100 =》 1mAsetts    (100)

1mAssetts =》100            (90)







了解Luna - Mirror - Anchor Protocol

> Anchor 将在 2 年内向 LUNA 质押者分发总量 1 亿枚 ANC 代币，也就是总供应量的 10％。在其他所有条件相同的情况下，这会使 LUNA 代币更有价值，因为这意味着 LUNA 的抵押收益提高了。
>
> 可以说，LUNA 代币成为一种事实上的直通代币，只要质押 LUNA 就有权获得基于 Terra 之上构建的其他产品的原生代币。
>
> bLUNA 是 Anchor 最初唯一支持的抵押品资产，并可获得 ANC 奖励。
>
> bLUNA 只能使用 LUNA 创建生成，这会导致投机者在市场上购买 LUNA，并将其作为抵押品存入 Anchor 中，这可能会导致 LUNA 出现供应方流动性危机。
>
> 由于目前 LUNA 总流通量中有 69％的代币处于质押状态，并且解质押需要 3 周的时间，这导致 LUNA 流动性危机会异常明显。

Anchor 还可对 LUNA 进行杠杆做多。这会同时增加市场对 LUNA 和 UST 的需求。具体来说，用户在 Anchor 平台上存入 bLUNA，借出 UST，并多次重复此操作对 LUNA 做多，从而增加了 LUNA 的需求。

此外，用户也可存入 bLUNA，并借出 UST 在 Terra 生态系统中其他协议上使用，比如，使用 UST 在 Mirror 上挖矿，这又会增加 UST 的市场需求。



质押稳定币

luna

[如何质押luna](https://how-to-stake-terra-luna-cn.kysenpool.io/)

[anchor介绍](https://www.chainnews.com/articles/455046196332.htm)





## 借贷逻辑

借贷衍生出几种情况：

- 存不稳定币（比如ETH,BTC,BNB,UNI等），贷出不稳定币（比如UNI,XVS等）。这种情况不仅要考虑存币价格的下跌，也要考虑贷出币价格的上涨，容易被清算，风险高。

- 存不稳定币，贷出稳定币（比如BUSD,USDT,USDC,DAI等）。这种情况只用关注存币价格的下跌，超过安全阈值会被清算。
- 存稳定币，贷出稳定币。这种情况貌似没必要，然而有可能存某种稳定币，贷出另一种稳定币。看自身情况而定。
- 存稳定币，贷出不稳定币。这种情况需要关注贷币价格的上涨，突然上涨超过安全阈值也会被清算。













